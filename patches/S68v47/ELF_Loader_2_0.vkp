;S68v47
;Загрузчик эльфов
;ELF Loader
;(c) Rst7/CBSIE, BoBa
;(p) ~Jhellico/Klaud
;Version: 2.0
;PatchID: 6946
;Details: https://patches.kibab.com/patches/details.php5?id=6946
;!к патчу прикреплён файл, https://patches.kibab.com/cnt.php5?d=s68v47&f=ELF_Loader_2_0.rar

/*
Загрузка всех .elf-файлов из каталога 0:\ZBin\Daemons
Загрузка необходимых .elf файлов при выборе файла с произвольным расширением
Обрабатывается при помощи ExtD.elf - необходим в каталоге 0:\ZBin\Daemons
по файлу 0:\ZBin\etc\extension.cfg. Формат файла:
>>>>---
 ;Это комментарий, он начинается с символа ;
 
 ;Универсальные для тех, у кого не указано какое-либо поле
 
 RUN=0:\ZBin\TED\TED.elf
 SMALL=0:\ZBin\img\UNK_SMALL.png
 BIG=0:\ZBin\img\UNK_LARGE.png
 ALTRUN=0:\ZBin\TED\TED.elf
 
 ;первый, расширение txt очень желательно указывать, т.к. по нему открываются неизвестные файлы
 [txt]
 SMALL=0:\ZBin\img\TXT_SMALL.png
 BIG=0:\ZBin\img\TXT_LARGE.png
 
 ;второй
[bcfg]
 RUN=0:\ZBin\utilities\CfgEdit.elf
 SMALL=0:\ZBin\img\BCFG_SMALL.png
 BIG=0:\ZBin\img\BCFG_LARGE.png
 
 ; и т.д.
 
 ; если поле не указано, то оно берется из первых
 ---<<<<<

Для упрощения формирования структуры каталогов разархивируйте в корень MMC архив ELFLoader_v2_0.zip с сохранением путей.

+Расширение таблицы регистрации расширений файлов

+Очередной перенос HELPER_PROC на cepid=440A для более корректной работы
 с жабой

+Расширение PIT при помощи .png файлов
 Обрабатываются файлы из каталога 0:\ZBin\img\ с именами %d.png
 для замены штатных картинок или из эльфов - указатель на строку
 с именем файла вместо ID (аналогично ESI)
*/
;SWILIB_FUNC171,SWILIB_FUNC172
#pragma enable old_equal_ff
0x000745C4: AC9107A0989107A0
;SWILIB_FUNC19C
0x00074670: D19107A0
;SWILIB_FUNC1B8_1BB
0x000746E0: BC5AD7A8C05AD7A8B85AD7A8C45AD7A8
;CODE,DATA_C
0x00078100: 11FF2FE1370100EB0100A0E3F081BDE8
0x00078110: 0F402DE9500100EB0070A0E10040A0E3
0x00078120: 0F80BDE8005080E20F402DE94A0100EB
0x00078130: 0060A0E10F80BDE80010A0E30F402DE9
0x00078140: 450100EB0050A0E10F80BDE80F402DE9
0x00078150: 410100EB0070A0E10050A0E30F80BDE8
0x00078160: 04E02DE500200FE1040000EF00100FE1
0x00078170: C01081E301F021E10000A0E10000A0E1
0x00078180: 0000A0E17AFF17EE0000A0E10000A0E1
0x00078190: 0000A0E1FAFFFF1A0000A0E39A0F07EE
0x000781A0: 0000A0E10000A0E10000A0E10000A0E1
0x000781B0: 150F07EE0000A0E10000A0E10000A0E1
0x000781C0: 0000A0E102F021E104F09DE400402DE9
0x000781D0: 1D0100EF0080BDE87FB5FFB00025ED43
0x000781E0: 0595642166A8FFF7F2EF7F9800246B46
0x000781F0: 802211020ADF0190002801D528003FE1
0x00078200: 6B46342209A90BDF342805D001986946
0x00078210: 0DDF0120C04333E109989B49884204D0
0x00078220: 019869460DDF0220F4E709A8808D0B28
0x00078230: 02D30820C04323E1029410E028680128
0x00078240: 0AD1A8680599884200D2059069694018
0x00078250: 844201D2A86844180298401C02900298
0x00078260: 09A9898D884229DA08A801B411980399
0x00078270: 0AAD6D8D01AB00226943411802980FDF
0x00078280: 1199039A0AAB5B8D01B05A4389188842
0x00078290: 04D0019869460DDF0320BBE7029816A9
0x000782A0: 40010D1801986B46202229000BDF2028
0x000782B0: C4D0019869460DDF0420BBE70598251A
0x000782C0: 280014DF040004D1019869460DDF0D20
0x000782D0: A0E72900FFF77AEF002054E003980068
0x000782E0: 012802D0022817D0B4E003980269002A
0x000782F0: 47D0806805996B46401A211801980BDF
0x00078300: 0399096988423CD0019869460DDF2000
0x00078310: 15DF0A20C043B3E00398006914DF0490
0x00078320: 002806D1019869460DDF200015DF0620
0x00078330: 70E703980499026901986B460BDF0399
0x00078340: 0969884208D0019869460DDF049815DF
0x00078350: 200015DF07206DE7002066AB05E0192A
0x00078360: 02DA496892009950401C049AC1005118
0x00078370: 0A68002AF3D17899002000292FD10498
0x00078380: 15DF0298401C02900598414207910298
0x00078390: 09A9898D884264DA400116A908180390
0x000783A0: 684601B4049801AB4168029800220FDF
0x000783B0: 0499496801B0884290D0019869460DDF
0x000783C0: 200015DF052025E7049DEB189A18059B
0x000783D0: 5218116862581219D21A6250401C789A
0x000783E0: C1009142CBD20399779B8968049D4A42
0x000783F0: C100AD186D18ED186D682D062D0E0695
0x00078400: FF2DEBD0FD2DDFD0079D069E6519002E
0x00078410: E4D0022E02D0172E09D012E0049EF318
0x00078420: 9A18521811686A5812196A50D6E7049E
0x00078430: F3189A18059B521811686A581219D21A
0x00078440: F3E7019869460DDF200015DF049815DF
0x00078450: 0C205FE7019869460DDF200015DF0B20
0x00078460: D8E6019869460DDF00F052F9079D0F9E
0x00078470: 829B819A80997F98A4196419A0470020
0x00078480: 7FB004B070BDC0467F454C4610B5A0B0
0x00078490: 694614007E22A3DF0023002221006846
0x000784A0: FFF79AFE002801D0002000E0012020B0
0x000784B0: 10BD000010402DE90040A0E10A00A0E3
0x000784C0: 440C80E3540100EF0C009FE5001090E5
0x000784D0: 0400A0E11040BDE808FFFFEA009007A0
0x000784E0: 10402DE948D04DE240DE4DE20140A0E1
0x000784F0: D20F8DE21A0000EF74109FE5D20F8DE2
0x00078500: 170000EF0D20A0E1D21F8DE204008DE2
0x00078510: 6B0000EF000050E30F00000A0410A0E1
0x00078520: D20F8DE21A0000EFB9108DE2D20F8DE2
0x00078530: 170000EF0030A0E30020A0E30210A0E1
0x00078540: D20F8DE223FFFFFA0D10A0E104008DE2
0x00078550: 6C0000EF000050E3EFFFFF1A0D10A0E1
0x00078560: 04008DE26D0000EF48D08DE240DE8DE2
0x00078570: 1080BDE8F08C07A030402DE930509FE5
0x00078580: 0040A0E1F70200EB140085E28C0000EF
0x00078590: 20009FE50520A0E10010A0E3710100EF
0x000785A0: 14009FE5001090E50400A0E13040BDE8
0x000785B0: D2FEFFEAF88C07A0E08407A0049007A0
0x000785C0: 00B580280BDB06490818803800788028
0x000785D0: 05DB044AFF21C94340001018405A00BD
0x000785E0: 8C8D07A00C8E07A030402DE90010A0E3
0x000785F0: 0040A0E10250A0E1260100EF030000EA
0x00078600: EEFFFFFA0010A0E10400A0E11C0000EF
0x00078610: 0100D5E4000050E3F8FFFF1A3080BDE8
0x00078620: 30402DE90040A0E10F00A0E3250100EF
0x00078630: 0050A0E1071F8FE2240100EF0020A0E3
0x00078640: 0510A0E10400A0E1940000EF0500A0E1
0x00078650: 290100EF3080BDE87478740010402DE9
0x00078660: 84409FE5000094E5000050E30400001A
0x00078670: 0400A0E3140000EF0010A0E3001080E5
0x00078680: 000084E5040080E21080BDE8F0412DE9
0x00078690: 54409FE5460100EF005094E52800A0E3
0x000786A0: 006095E5900607E02C0087E2140000EF
0x000786B0: 0080A0E1042087E20510A0E11E0100EF
0x000786C0: 010086E2000088E50500A0E1150000EF
0x000786D0: 008084E5470100EF0A00A0E3900601E0
0x000786E0: 010188E0040080E2F081BDE8BC5AD7A8
0x000786F0: 054A00B5914203D0044A1268904700BD
0x00078700: 3000FFF78EEF00BDD11D0000089007A0
0x00078710: 004B1847608107A000B5080014DF00BD
0x00078720: 00B5080015DF00BD31402DE90140A0E1
0x00078730: 0250A0E15E0100EF000090E50D30A0E1
0x00078740: 0520A0E10410A0E10B0000EF3180BDE8
0x00078750: F0412DE928D04DE20040A0E300408DE5
0x00078760: 04408DE50C308DE28020A0E3801CA0E3
0x00078770: 0A0000EF08008DE5010070E30100001A
0x00078780: 0000A0E3C30000EA0C00A0E3140000EF
0x00078790: 0050A0E1004085E5044085E5084085E5
0x000787A0: 08009DE50C308DE20820A0E320108DE2
0x000787B0: 0B0000EF080050E31B00001A0810A0E3
0x000787C0: 20008DE2B20100EF000050E31600000A
0x000787D0: C8029FE501002DE9C4029FE501002DE9
0x000787E0: 0000A0E301002DE90030A0E10020A0E1
0x000787F0: 0010A0E1AC029FE5A80100EF0C008DE5
0x00078800: 000050E30CD08DE20700000A560100EF
0x00078810: 04008DE5000050E30F00001A0020A0E3
0x00078820: 0210A0E10D00A0E1570100EF000095E5
0x00078830: 150000EF040095E5150000EF080095E5
0x00078840: 150000EF0500A0E1150000EF08009DE5
0x00078850: 0C108DE20D0000EFC8FFFFEA00009DE5
0x00078860: 620100EF000050E30020A01304108D12
0x00078870: EBFFFF1A30229FE500009DE508108DE2
0x00078880: A90100EF00009DE50810A0E3580100EF
0x00078890: 04109DE500009DE5590100EF0000A0E3
0x000788A0: 01002DE901002DE901002DE924008DE2
0x000788B0: 01002DE92C008DE201002DE918109DE5
0x000788C0: 28308DE214009DE524208DE25A0100EF
0x000788D0: 30009DE514D08DE2100050E30100001A
0x000788E0: 00009DE5AF0100EF1C009DE5080050E3
0x000788F0: 010000AA00009DE5B00100EF18009DE5
0x00078900: 030050E30100001A00009DE5AB0100EF
0x00078910: 18009DE5000050E3040050130100001A
0x00078920: 00009DE5B10100EF00009DE504109DE5
0x00078930: 1020A0E3AC0100EF000050E30100000A
0x00078940: 00009DE5AD0100EF00009DE50120A0E3
0x00078950: FF10A0E3AE0100EF04109DE500009DE5
0x00078960: 0080A0E3AA0100EF00009DE504109DE5
0x00078970: 5F0100EF140000EF000085E50800A0E3
0x00078980: 140000EF0060A0E1086085E510009DE5
0x00078990: 14109DE5910000E08000A0E1140000EF
0x000789A0: 040085E50070A0E1000000EA018088E2
0x000789B0: 14009DE5000058E11B00002A001095E5
0x000789C0: 00009DE50020A0E3600100EF0400A0E1
0x000789D0: 7ECEA0E30A0000EA0020D1E5F83CA0E3
0x000789E0: 022403E00130D1E50210D1E583310CE0
0x000789F0: 022083E1A111A0E1021081E1B210C7E0
0x00078A00: 010080E210109DE5010050E1E6FFFF2A
0x00078A10: 001095E5001181E00320D1E5000052E3
0x00078A20: ECFFFF1AE01CA0E3F3FFFFEA080095E5
0x00078A30: 0810A0E3B210C0E1080095E510109DE5
0x00078A40: 0010C0E5080095E514109DE50110C0E5
0x00078A50: 080095E5041095E5041080E504109DE5
0x00078A60: 00009DE55D0100EF0020A0E304108DE2
0x00078A70: 0D00A0E1570100EF000095E5150000EF
0x00078A80: 0500A0E1150000EF08009DE50C108DE2
0x00078A90: 0D0000EF0600A0E128D08DE2F081BDE8
0x00078AA0: 218707A0198707A00C8F07A0288707A0
0x00078AB0: 00B507E0412A02DB5B2A00DA2032491C
0x00078AC0: 0270401C0A78002AF4D10021017000BD
0x00078AD0: 3030A0E3010000EA010040E0013083E2
0x00078AE0: 010050E1FBFFFF2A0030C2E51EFF2FE1
0x00078AF0: 10402DE90040A0E10100A0E10A0050E3
0x00078B00: 1600003A640050E31000003AFA0F50E3
0x00078B10: 0A00003A1010A0E39C1D81E3010050E1
0x00078B20: 0200003A0420A0E1E8FFFFEB014084E2
0x00078B30: 0420A0E1FA1FA0E3E4FFFFEB014084E2
0x00078B40: 0420A0E16410A0E3E0FFFFEB014084E2
0x00078B50: 0420A0E10A10A0E3DCFFFFEB014084E2
0x00078B60: 300080E20000C4E50000A0E30100C4E5
0x00078B70: 1080BDE8F0432DE940DF4DE20040A0E1
0x00078B80: 240EA0E10A0050E30300001A0410A0E1
0x00078B90: 0D00A0E1C5FFFFFA080000EA44519FE5
0x00078BA0: 0D00A0E10510A0E1C0FFFFFA0410A0E1
0x00078BB0: CEFFFFEB101085E20D00A0E1170000EF
0x00078BC0: 24519FE5460100EF0560A0E10070A0E3
0x00078BD0: 0080A0E3000000EA0680A0E1006096E5
0x00078BE0: 000056E30D00000A040096E50D10A0E1
0x00078BF0: 190000EF000050E3F6FFFF1A000058E3
0x00078C00: 00009615000088150000951500008615
0x00078C10: 00608515470100EF080096E52F0000EA
0x00078C20: 470100EF0D00A0E1C8FEFFEB0060A0E1
0x00078C30: 0C00A0E3140000EF0040A0E10D00A0E1
0x00078C40: 1B0000EF010080E2140000EF040084E5
0x00078C50: 0D10A0E11A0000EF086084E5460100EF
0x00078C60: 000095E50090A0E3000084E5004085E5
0x00078C70: 0560A0E10680A0E1006096E5000056E3
0x00078C80: 0100001A470100EF130000EA019089E2
0x00078C90: 330059E3F6FFFF3A007088E5470100EF
0x00078CA0: 080096E5000050E30300000A040090E5
0x00078CB0: 150000EF080096E5150000EF040096E5
0x00078CC0: 0680A0E1150000EF006096E50800A0E1
0x00078CD0: 150000EF000056E3F0FFFF1A080094E5
0x00078CE0: 40DF8DE2F083BDE8148F07A0C05AD7A8
0x00078CF0: 2A2E656C66000000303A5C5A42696E5C
0x00078D00: 4461656D6F6E735C00000000688D07A0
0x00078D10: 5500000000089D057C8D07A0848D07A0
0x00078D20: 6C8D07A0748D07A0FBC0FF7F8D8407A0
0x00078D30: 00000000303A5C5A42696E5C696D675C
0x00078D40: 656C665F736D616C6C2E706E67000000
0x00078D50: 303A5C5A42696E5C696D675C656C665F
0x00078D60: 6269672E706E6700656C66004F70656E
0x00078D70: 00000000416C744F70656E00348D07A0
0x00078D80: 00000000508D07A0000000005F5F275F
0x00078D90: 223AC5D85F255F3C5F5F5F5F5F272722
0x00078DA0: 22072D2D5F545F3E5F5F5F5FFFF6F75F
0x00078DB0: FD83B315F063F23CBF2D52F4F82B4969
0x00078DC0: A3E714FAF1FCF33E5F5F5FF580818283
0x00078DD0: 8485868788898A8B8C8D8E8F90919293
0x00078DE0: 9495969798999A9B9C9D9E9FA0A1A2A3
0x00078DF0: A4A5A6A7A8A9AAABACADAEAFE0E1E2E3
0x00078E00: E4E5E6E7E8E9EAEBECEDEEEF10041104
0x00078E10: 12041304140415041604170418041904
0x00078E20: 1A041B041C041D041E041F0420042104
0x00078E30: 22042304240425042604270428042904
0x00078E40: 2A042B042C042D042E042F0430043104
0x00078E50: 32043304340435043604370438043904
0x00078E60: 3A043B043C043D043E043F042D002D00
0x00078E70: 2D00A6002B00A600A600AC00AC00A600
0x00078E80: A600AC002D002D002D00AC004C002B00
0x00078E90: 54002B002D002B00A600A6004C003304
0x00078EA0: A6005400A6003D002B00A600A6005400
0x00078EB0: 54004C004C002D0033042B002B002D00
0x00078EC0: 2D002D002D00A600A6002D0040044104
0x00078ED0: 42044304440445044604470448044904
0x00078EE0: 4A044B044C044D044E044F0401045104
0x00078EF0: 04045404070457040E045E04B0002220
0x00078F00: B70076001621A400A600A000312E322E
0x00078F10: 35000000303A5C5A42696E5C696D675C
0x00078F20: 000000002E706E6700000000
;RET_ADRS
0x00079000: 2F252DA017232DA02BCF7FA08C098AA0
0x00079010: CBB37FA0
;HELPER_PROC,HELPER_PROC_DATA
0x00079100: 00402DE914D04DE20D00A0E1530100EF
0x00079110: 000050E31100000A04309DE508009DE5
0x00079120: 010053E30500001A0C209DE5000052E3
0x00079130: 0A00000A10109DE532FF2FE1070000EA
0x00079140: 01002DE904209DE5AE10A0E3DE1C81E3
0x00079150: 0900A0E3420C80E3000100EF04D08DE2
0x00079160: 14D08DE20080BDE800402DE91C209FE5
0x00079170: 1C109FE50000A0E301002DE98030A0E3
0x00079180: 0A00A0E3440C80E3050100EF0180BDE8
0x00079190: 009107A0DC9107A000402DE9460100EF
0x000791A0: 410100EF470100EF0080BDE800402DE9
0x000791B0: 04002DE90030A0E10A00A0E3440C80E3
0x000791C0: 0120A0E10110A0E3000100EF0180BDE8
0x000791D0: 10B514008847200015DF10BD48454C50
0x000791E0: 45520000
;PIT_PNG_EXTENSION
0x00079500: 10402DE90040A0E199FDFFEB000050E3
0x00079510: 1080BD180400A0E114C51FE53CFF2FE1
0x00079520: 040050E11CC51FE51CFF2FE1
;PATCH_EXT2_JUMPERS
#pragma disable old_equal_ff
0x001C0CD8: 0A43747841455F50 0CF09FE50CF09FE5
0x001C0CE0: 535F46696E6446696C65496E576F726B 0CF09FE50CF09FE50CF09FE5108107A0
0x001C0CF0: 4469725F436C6F7365282920456E7472 248107A0388107A04C8107A08C8607A0
;PATCH_EXT2_R5R7
0x0026ED30: 0025284F 51F7D8EF
;PATCH_EXT2_CLUST2
0x0026ED50: 2048 3800
;PATCH_EXT2_R5R1
0x0026EE2E: D84D 51F7
0x0026EE30: 0021 58EF
;PATCH_EXT2_R4R7
0x0026EFC6: 0024714F 51F788EE
;PATCH_EXT2_CLUST1
0x0026EFF2: 6748 3800
;PATCH_EXT2_IMPL
0x0026F010: 5F4A043A11683C2909DA28204843131D 51F76AEEC046C046C046C046C046C046
0x0026F020: C01801311160 C046C046C046
;PATCH_EXT2_R6R5
0x0026F0E0: 2B4E051C 51F7FCED
;PATCH_ONCREATE
0x003F75CC: 17232DA0 788507A0
;PATCH_ONCLOSE
0x003F75E0: 2F252DA0 B48407A0
;PATCH_NO_BROWSE_TXT
0x00464E76: 0830 3030
;PATCH_SHOWMSG_BLF
0x00518810: 2BCF7FA0 F18607A0
;PATCH_ESI1
0x007A93E0: 181301FA 08F09FE5
;PATCH_ESI2
0x007A93F0: 7C25647C 048107A0
;PATCH_GET_PIT,PATCH_GET_PITJ
0x007FB3C0: 10B5041CA5F0E2EA 00490847009507A0

;------------------------- end -------------------------

