;CX70v56
;Собственная мелодия для каждого в адреске
;Own melody for each entry in addressbook
;(c) Lost
;Version: 
;! доступна новая версия патча, https://patches.kibab.com/patches/details.php5?id=8262
;PatchID: 8257
;Details: https://patches.kibab.com/patches/details.php5?id=8257
/*
07.10.2007

При входящем звонке телефон играет заданную для контакта в адресной книге мелодию
Имя файла мелодии нужно писать в поле "Страна" полностью, например, так: 0:\Sounds\Quake.wav
Если имя файла не указано, или файла с таким именем не существует, то будет играть мелодия для группы

Анализ функций: OwnMelody.vkp

0A:__arm int fopen
0B:__arm int fread
0D:__arm void fclose
0F:__arm unsigned int lseek
14:__arm void *malloc
15:__arm void mfree
1B:__thumb unsigned int strlen
4A:__arm void PlayFile
6E:__thumb int IsCalling
A3:__arm void ws_2str
117:__thumb char * strrchr 
11D:__arm void  zeromem
123:__thumb int  wstrlen 
125:__thumb WSHDR * AllocWS
129:__thumb void  FreeWS 
16C:__arm int str_2ws
16D:__thumb int UnpackABentry
16E:__thumb int FreeUnpackABentry

*/
;CODE
#pragma enable old_equal_ff
0x00803000: F0402DE904D04DE20140A0E10D30A0E1
0x00803010: 8020A0E3801CA0E30A0000EF0050A0E1
0x00803020: 010075E31D00000A0D00A0E101002DE9
0x00803030: 04308DE20220A0E30010A0E30500A0E1
0x00803040: 0F0000EF0060A0E1140000EF0070B0E1
0x00803050: 04D08DE20C00000A0D00A0E101002DE9
0x00803060: 04308DE20020A0E30010A0E30500A0E1
0x00803070: 0F0000EF04308DE20620A0E10710A0E1
0x00803080: 0500A0E10B0000EF04D08DE20D10A0E1
0x00803090: 0500A0E10D0000EF000057E30100001A
0x008030A0: 0000A0E3F280BDE81C10A0E30400A0E1
0x008030B0: 1D0100EF2830A0E3042046E2041087E2
0x008030C0: 0400A0E16D0100EF0700A0E1150000EF
0x008030D0: 0100A0E3F280BDE868209FE510002DE9
0x008030E0: 0110D0E50020D2E5020051E10400001A
0x008030F0: 54209FE50210D0E50020D2E5020051E1
0x00803100: 0200000A1000BDE80000A0E31EFF2FE1
0x00803110: 38309FE50020A0E3050080E2040000EA
0x00803120: 01C0D0E40140D3E404005CE1F4FFFF1A
0x00803130: 012082E2010052E1F8FFFFBA1000BDE8
0x00803140: 0100A0E31EFF2FE15DF168A85EF168A8
0x00803150: 61F168A8F94F2DE920D04DE20140A0E1
0x00803160: 0250A0E10060A0E30090A0E30670A0E1
0x00803170: 0680A0E16E0000EF000050E35700000A
0x00803180: B0019FE504108DE2000090E59BFFFFEB
0x00803190: 000050E35100000A00A0A0E3030000EA
0x008031A0: 0900A0E1150000EF0090A0E301A08AE2
0x008031B0: FA00DDE100005AE1290000AA10109DE5
0x008031C0: 0C00A0E3901A2BE00100DBE5010050E3
0x008031D0: 08009B1500005013F3FFFF0A0310DBE5
0x008031E0: 281051E20B00000A021041E2030051E3
0x008031F0: 0100009A341051E2EBFFFF1A0710B0E1
0x00803200: E9FFFF1AB3FFFFEB000050E3E6FFFF0A
0x00803210: 0170A0E3E4FFFFEA230100EF010080E2
0x00803220: 00008DE5140000EF00209DE50090A0E1
0x00803230: 08009BE50910A0E1A30000EF0D30A0E1
0x00803240: 8020A0E3801CA0E30900A0E10A0000EF
0x00803250: 010070E3D1FFFF0A0D10A0E10D0000EF
0x00803260: D1FFFFEA158000EF0010A0E104008DE2
0x00803270: 6E0100EF000057E3000059131700000A
0x00803280: 5C10A0E30900A0E1170100EF014080E2
0x00803290: 0400A0E11B0000EF017080E20700A0E1
0x008032A0: 250100EF0050A0E10720A0E10410A0E1
0x008032B0: 6C0100EF0060C4E50900A0E11B0000EF
0x008032C0: 016080E20600A0E1250100EF0040A0E1
0x008032D0: 0620A0E10910A0E16C0100EF0180A0E3
0x008032E0: 50009DE50520A0E101002DE950009DE5
0x008032F0: 0410A0E101002DE92C309DE528009DE5
0x00803300: 4A0000EF0060A0E1000058E308D08DE2
0x00803310: 0500000A0400A0E1290100EF0500A0E1
0x00803320: 290100EF0900A0E1150000EF0600A0E1
0x00803330: 28D08DE2F08FBDE830C36EA8
;PATCH_ENTRY
#pragma disable old_equal_ff
0x0099BBA4: 102CFFEB 6A9DF9EB

;------------------------- end -------------------------

