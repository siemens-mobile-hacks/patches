;E71v45
;Модификация медиаплеера
;Media player modification
;(c) FIL
;(r) alfinant, Marie
;Version: 1.12
;PatchID: 11152
;Details: https://patches.kibab.com/patches/details.php5?id=11152
/*
- Ускорено переключение треков/изображений.
- Отключена обработка отключения подсветки.
- Принудительное обновление данных о треке в памяти. Требуется для корректной работы функций GetLastAudioTrackFilename, GetLastAudioTrackDir.
- Возможность изменять громкость при заблокированной клавиатуре.
- Отключено сворачивание приложения при заблокированной клавиатуре. Устраняет зависание при сворачивании через XTask.
- Исправлен выбор плейлиста.
- Отключено сообщение "Add tracks to playlist.".
- Пункты меню "Attribures" заменены на "Go to...".
- Отключены пункты меню "Помощь".
БД:
- Отключено добавление png файлов только из каталогов "X:\zbin\".
- Увеличено количество отображаемых элементов списка.
- Уменьшен размер иконок и превью до 26x26.
Аудио режим:
- Начальная поддержка обложек! Поддерживаются теги ID3v2.3, ID3v2.4 с кодировкой мета-данных ISO8859_1. Максимальный размер обложки 512 Кб.
- Медиаплеер всегда открывается в режиме анимации/обложки. Если открыть список воспроизведения, то плеер автоматически перейдет в режим анимации/обложки при неактивности в течении 5 секунд.
- Визуализация реализована стандартными примитивами без использования графики.
- Изменен формат названия трека. Было: "%TITLE / %ARTIST", стало: "%ARTIST - %TITLE".
- В режиме списка отображение названия трека в заголовке.
- Горячие клавиши:
-- '#'(LONG_PRESS) - выход на главный экран и блокировка клавиатуры
-- Режим анимации/обложки:
--- LEFT_BUTTON - предыдущий трек
--- RIGHT_BUTTON - следующий трек
--- UP_BUTTON, DOWN_BUTTON - открытие списка воспроизведения
Просмотрщик изображений:
- Отображение разрешения изображения в правом верхнем углу.
- Отключены софт-кнопки(Info, Back) в режиме зуммирования картинки.
- Горячие клавиши:
-- LEFT_BUTTON, UP_BUTTON - предыдущее изображение
-- RIGHT_BUTTON, DOWN_BUTTON - следующее изображение
Видео режим:
- Горячие клавиши:
-- LEFT_BUTTON - предыдущее видео
-- RIGHT_BUTTON - следующее видео
-- Режим поворота:
--- UP_BUTTON - предыдущее видео
--- DOWN_BUTTON - следующее видео
*/

#pragma enable old_equal_ff
; .rodata
13818A0: 4944330041504943006A7067006A70656700706E6700676966002564782564007A62696E5C000000A91838A1AD1838A1B21838A1B61838A1
#pragma disable old_equal_ff

; .DisableBacklightFadeHandler
07A5010: 40CF45E2 FEC045E2

; .StoreLastPlayMelodyOnChangeTrack
0792A04: E8308FE200308DE50230A0E35320A0E318119FE5 DC07D4E1010050E30400A001990E000B010000EA

; .DisableAutoPlayInMenu_Part1
079D584: FA6C011B 0000A011

; .DisableAutoPlayInMenu_Part2
078BB5C: 114700EB 0000A0E1

; .SetAnimationViewMode
078B974: 2C2700EB 0000A0E3

; .FastSwitch_Part1
079056C: 0210A0E3 0310A0E3

; .FastSwitch_Part2
0792A20: 0410A0E3 0310A0E3

; .FastSwitch_Part3
078AABC: 1E03001A 0000A0E1

; .FastSwitch_Part4
078B0D8: 9701001A 0000A0E1

; .ChangeVolumeWhenKbdIsLocked
0796AA8: 000090E5 0000A0E3

; .DisableHideWhenKbdIsLocked
072B31C: 40009FE5 060000EA

; .FixSelectPlaylist
07CDA58: 28108DE5 0000A0E1

; .DisableMessage_AddTracksToPlaylist
07EE598: 2E8105FB 0000A0E1

#pragma enable old_equal_ff
; .PlayProc
13818EA: 000037B50D4B04009847836905001B68002B10D1943423681868084B984723681B690200834206D01D2300930549EB680548054CA04737BDC0464F6595A0BB2D95A05380000009420000AB1E09A0

; .HideListProc
138193A: 000010B5024B0121984710BDC046BC097AA0

; .InitData
1381E30: 10B5044B040018209847034B1821A061984710BD512F09A000FCFAA0
#pragma disable old_equal_ff

; .InitData_Jump
072C570: A0129FE5AE8006FB 0400A0E12D5631FA

#pragma enable old_equal_ff
; .DestroyData
1381E60: 70B50E4D040080694369002B07D05869A847A3695869A847A069002343610369002B07D09868A847A3691869A847A06900230361A8470023A36170BD932F09A0
#pragma disable old_equal_ff

; .DestroyData_Jump
072C36C: D4119FE52F8106FB 0400A0E1BA5631FA

#pragma enable old_equal_ff
; .OnKey
138194C: F0B5794B85B002900C00984763685F689D68029BC43301901B781B061B16012B00D0AFE0029B816994331B686F4A1B6889680393C06E6E4B6E4EB0479422FF32974205D1232D0CD10120404205B0F0BD9623FF339F4204D1232D02D1664B9847F2E7029B9D331B78012B2ED16388253B1B041B0C012B02D815236380AEE0974200D0A2E02B003D3B012B00D9A6E0019B9B691D60D8E7CA235B009F4200D09DE0019B9B691B68AB4200D097E03D2D04D163683B229A602623DFE73E2D00D08DE063683C229A602523D7E7019BCC331B68002B07D1019B78331B78033B1B061B0E012B1CD82B003B3B012BADD9974275D09623FF339F4271D0CA235B009F426DD1019B99690B68AB4268D10023FA220B6002983A4B4968374C5200A04794E7974203D09623FF339F42E6D13B2D13D10398334B9847411E03D50398324B9847411E0398314B9847314B02989847019B3B229B691A6078E73C2D40D1294B03989847284B441C03989847A04200DC00240398254B21009847254B02989847019B3C229B69E6E7002B09D163881A00273A012A02D9053A012A21D8023B6EE7022B1DD1019BEC331B88002B18D16388253B1B041B0C012B00D847E72B003D3B012B0DD89423FF339F4200D161E79623FF339F4200D060E7019B00229B691A6002980C4B2100984732E7C0464F6595A0881300003D1938A1FBCB94A073836EA0ED1838A1
1381B4C: BB2D95A0330F95A0990C95A08CCD79A01CA878A0
#pragma disable old_equal_ff

; .OnKey_Jump
088B8EC: 1CA878A0 4D1938A1

#pragma enable old_equal_ff
; .GHook
1381B70: F8B5194B05000E00984703007C331B7804001B061B16012B0BD1022E0ED18769124B28009847114BA469786028009847A060310028000E4B9847F8BD032E09D183690C4F59682800B847A36928009968B847EEE70A2EECD18169074B074A8968C06E074CA047E4E74F6595A067CB94A074B778A0ABCC94A03D1938A188130000FBCB94A0
#pragma disable old_equal_ff

; .GHook_Jump
088B8F0: 74B778A0 711B38A1

#pragma enable old_equal_ff
; .BaseOnRedraw_Hook
1381C10: 0300C433F0B51B7889B01B0604001B16012B45D103009D331B78002B40D1224B02209847230094331B6802211F681F4B079020009847002802D043681B6898473B6800250022995E194E059104229B5E05985B1A0693079B069903931E232A00019300912B0038210295B0473B681E220620195E07980192069A0B00383B0390009205982A000295B047084B290020009847A84202D043681B68984709B0F0BD044B2000F9E7C046956AA2A03928A2A071CBA0A0EF5B95A0
#pragma disable old_equal_ff

; .BaseOnRedraw_Jump
079F808: F7D806FB 00892FFA

#pragma enable old_equal_ff
; .SetHeaderToListView
1381D00: 70B50B4B0600402098470A4B0221050030009847041E09D0074B2900300098472000064B064A074C2900A04770BDC04611F693A03928A2A0A8067AA0932F09A0512F09A0B985A2A0
#pragma disable old_equal_ff

; .SetHeaderToListView_Jump
079D0E0: 5420A0E3D2BD04FB 0400A0E105932FFA

#pragma enable old_equal_ff
; .SetHeaderToAnimationView
1381D50: 70B50B4B0400402098470A4B0221050020009847041E09D00748084B290098472000074B074A084C2900A04770BDC04611F693A03928A2A0070D0000305F8DA0932F09A0512F09A0B985A2A0
#pragma disable old_equal_ff

; .SetHeaderToAnimationView_Jump
079CF48: 601FA0E338BE04FB 0400A0E17F932FFA

#pragma enable old_equal_ff
; .SetHeaderScrollText_Hook
1381DA0: 70B51E000300C4331B780C001B0615001B16012B07D0044B0221984721003300024C2A00A04770BD3928A2A0B985A2A0
#pragma disable old_equal_ff

; .SetHeaderScrollText_Jump
078BBA4: 0700A0E182720AFA 0400A0E17CD82FFA

#pragma enable old_equal_ff
; .ChangeTrackName
1381DDA: 000070B50A4D04000E0001222021A847200001222D21A847200001222021A8473100034B01222000984770BDC0468DB44FA01FB64FA0
#pragma disable old_equal_ff

; .ChangeTrackName_Jump
07A0768: 64108FE20600A0E1B07B06FB0510A0E1 0510A0E10600A0E199852FFA010000EA

#pragma enable old_equal_ff
; .ID3v2_GetIMGHDRFromPICFrame
1381F00: 8369F0B53D4C89B00600586906AB02930123019300930322406800232D21A047051E68D0B369364C5A6900211369D268A047002803D080231B0298425BDB7822304B110028009847002803D080231B02984250DB2C4B052128009847002803D080231B02984246DB284B28009847002803D080231B0298423DDB0023079307A9234B28009847002803D080231B02984231DB079B1F4F1A790220195E1206120E0020185E1C4B98471C4B05900C20984707990C220400B847184B05989847079B059AA0609968B847154B28009847B3695A69002A08D05069124DA847B3695869A847B36900225A611C61621E944164001C7309B0F0BD0024E6E7C046B001CDA0E8CCCCA01CB0CCA00CB6CCA018B6CBA090C2CCA0A4FCFAA05DCF94A0512F09A094BACBA0932F09A0

; .ID3v2_ReadCover
1382270: F0B5C24C0500A544AB691A7B012A00D1F1E05A6900241C73A24207D05069BC4EB047AB695869B047AB695C611B69002B08D09868B64CA047AB691869A047AB6900221A616F6F032F00D0D0E0B14B7F2228A919A898472A6BE96AAF4B19A898478021AE4C08AB8022090219A8A0470390431C00D1BBE00BACA94E08AB0A222100B04706000A2800D0ADE0A649A64B3A0020009847002800D0A5E0E378033B1B061B0E012B00D99EE0637906221A4200D100E168909A4E039808AB023A68A9B047042800D08FE0994B68A89847E378BB4200D104300A30059000230493934B0DA89847059B98427AD90EAC03988C4E08AB0A222100B0470A2871D1227800211300413B1B061B0E0F3098424941002902D1303A092A63D8627800211300413B1B061B0E192098424941002902D1303A092A55D8A27800211300413B1B061B0E192098424941002902D1303A092A47D8E27800211300413B1B061B0E192098424941002902D1303A092A39D8636820001A041902120E5218190C09021B0E5B181B041B0C12041A4306926949674B04229847061E14D1674F1820B84704000698B8470AAB069A5E4F010060610398B847069B984224D06069564EB0472000B047069B059A0A33D318059309AB009305990398594C08AB0022A047013000D07EE7049B002B00D06BE00398544B08A99847A9239B009D44F0BD524B3220984704E76369
1382470: 1A782270002AD5D101330793414B7F3268A91EA81F00984711A9072223A8B847484B15AA83CB83C21B681EA813600799454B7F2298473700BB0015A959580722424B23A89847424B012223A91EA89847404B98422AD0404B23A8984706006660002EA7D03D4E0798B04763691A1892782272032A01D0002A9CD1C71CD819B0476369802212030130C0191B18E360069B0A3B1B1A2361934200D38BE7237A032B1DD0002B00D08AE7049488E70137042FC2D1D4E705960FE7214B32209847AB691A7B012AF8D0049A01215A610022197323480092234B244C2A00A04783E7AB69012100225C6119731D481E4B00921E4C2A00A047049B002B00D174E7049B044C5869A0470498A0476DE7C0465CFDFFFF932F09A05BB24FA034055DA0A48456A0248556A0A01838A101B022A150B379A0A41838A1512F09A0188456A0B88356A050CD09A0C81838A153BC4FA0B08A56A051B64FA0FFFF0000242650A085AF22A10A440000011F38A1AB1E09A0
#pragma disable old_equal_ff

; .ID3v2_ReadCover_Jump
0792280: 54119FE56AE904FB 0400A0E1F9BF2FFA

#pragma enable old_equal_ff
; .DrawCover
1382600: 7F402DE9BC309FE50050A0E10140A0E133FF2FE1183090E50060A0E10C00D3E5010050E32500000A020050E30500000A94309FE50410A0E10500A0E110D08DE27040BDE813FF2FE1103093E5000053E31A00000A003095E5F440D3E1F030D3E1034044E064309FE533FF2FE1002095E55F10A0E30030A0E1F000D2E10020A0E30C308DE57830A0E308208DE504308DE500408DE52730A0E334409FE534FF2FE1183096E55F10A0E3102093E524309FE53C00A0E310D08DE27040BDE813FF2FE110D08DE27080BDE84F6595A09CE479A0956AA2A071CBA0A097CAA0A0
#pragma disable old_equal_ff

; .DrawCover_Jump_1
079F6AC: 7AFBFFEB D38B2FEB

; .DrawCover_Jump_2
079F92C: DAFAFF1B 338B2F1B

; .DisableVisualizerBG
079E528: 000094E5 310000EA

#pragma enable old_equal_ff
; .DrawVisualizer_Hook
13827E0: F0B52B4B91B00C0005000AA9100009AA9847284B02200A9E98472300EF22383B210001960092244E0390002002000290B0470A9BE3186C1EDF350493069523000C330593049B0027DD1F1C4B0EA90CA898470EAA0CA91A4B0BA898470B98194B9847194B9847194B184004D5082301385B4218430130874205DD069B10349C42DDD111B0F0BD124E1720B047013707906420B047079AEB1D01920022290000920C4E059A0B3D02902000B047CDE7C046EC477AA0956AA2A071CBA0A0FBF38CA0D5A258A025FBFAA0837BD3A007000080318094A093C1A0A0
#pragma disable old_equal_ff

; .DrawVisualizer_Jump
079E61C: 88B809FA 6F902FFA

#pragma enable old_equal_ff
; .DrawResolution
1382900: F0B5274B9FB004009847002843D0436F282B40D0C6235B00C358002B3BD02200C43212781206121635D122009C321278002A30D12200FC32D569002D2BD11C229E5E1E27DF5F33003B43AB4223D0154B1F220EA909A89847320013493B00134E09A8B047124B08209847124E07906420B04707006520B047242302931C3B0193079B2900383300930B4DED2338220397049009A8A847094B200098471FB0F0BD4F6595A05BB24FA0BA1838A14DEB93A07823A3A0318094A0ABA394A05CE179A0
#pragma disable old_equal_ff

; .DrawResolution_Jump
079F9B0: E9F9FFEB D28B2FFA

; .Zoom_DisableSoftKeys_Part_1
079F8CC: 180194E5 360000EA

; .Zoom_DisableSoftKeys_Part_2
08AF4E4: 040004009A000000 00000000FFFFFF7F

; .Zoom_DisableSoftKeys_Part_3
08AF500: FC030000 FFFFFF7F

#pragma enable old_equal_ff
; .Options_GoTo
1382BB0: 70B50C4B050068200E00984768210A4B0400984726236360253BE660A56063612000064B9847064B050020009847280070BDC046512F09A000FCFAA0249969A0932F09A0
#pragma disable old_equal_ff

; .Options_ReplaceAttributes_Part1
08AF24C: 8F070000 1B080000

; .Options_ReplaceAttributes_Part2
07CC398: 511BFDEB 04DA2EFA

; .Options_RemoveHelpItem
08AF394: A2050000 5C050000

#pragma enable old_equal_ff
; .MDB_IsAllowFile
1382750: 10B50F4B96B004001F2206A901A898470C4B0D491F2201A898470C4B20009847272804D00A4B2000984716B010BD094B032201A9200098470428F3D10538F4E75BB24FA0B08A56A0C01838A1F82650A0D05B72A051B64FA0
#pragma disable old_equal_ff

; .MDB_IsAllowFile_Jump
0725C30: E6FFFFEB C67231FA

#pragma enable old_equal_ff
; .MDB_FixUI_Hook
1382B90: 902310B58B61014B984710BDDB4095A0
#pragma disable old_equal_ff

; .MDB_FixUI_Jump
079A930: DBF206FB 96A02FFA

; .MDB_UseSmallIcons
0730928: 0130A0E3 0030A0E3

; .MDB_FixPreviewSize
079A030: 0018A0E12118A0E1 1A10A0E31A20A0E3

; .MDB_Options_ReplaceAttributes_Part1
08AA774: 8F070000 1B080000

; .MDB_Options_ReplaceAttributes_Part2
0799908: F5E5FDEB A8A42FFA

; .MDB_Options_RemoveHelpItem
08AA7C0: A2050000 5C050000

;------------------------- end -------------------------

